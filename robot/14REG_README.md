# ๐ ูุงฺูู ุซุจุช ูุงู ููุดููุฏ (14reg.js)

## ๐ ุฎูุงุตู
ูุงฺูู `14reg.js` ฺฉ ุณุณุชู ุซุจุช ูุงู ฺฉุงูู ู ููุดููุฏ ุจุฑุง ูุฏุฑุณู ุชูุงูุช ูุฑุขู ุงุณุช ฺฉู ุจุฑ ุงุณุงุณ ุฑุงูููุง `13REG_GUIDE.md` ุณุงุฎุชู ุดุฏู ุงุณุช.

## โจ ูฺฺฏโูุง ฺฉูุฏ

### ๐ **ูุฑุงุญู ุซุจุช ูุงู**
- **ูุฑุญูู 1:** ุฏุฑุงูุช ูุงู ู ูุงู ุฎุงููุงุฏฺฏ
- **ูุฑุญูู 2:** ุฏุฑุงูุช ฺฉุฏ ูู 10 ุฑูู  
- **ูุฑุญูู 3:** ุฏุฑุงูุช ุดูุงุฑู ุชููู (ุจุง ุฏฺฉูู ุงุฑุณุงู ุชูุงุณ)
- **ูุฑุญูู 4:** ุชุฃุฏ ููุง ู ุชฺฉูู ุซุจุช ูุงู

### ๐จ **ุฑุงุจุท ฺฉุงุฑุจุฑ ุจูุจูุฏ ุงูุชู**
- **ฺฉุงุฑุจุฑ ูุงุดูุงุณ:** ุฎูุดุงูุฏฺฏู + ุฏฺฉูู ุซุจุช ูุงู ูุณุชูู
- **ฺฉุงุฑุจุฑ ูุงูุต:** ุฏุฑุฎูุงุณุช ุชฺฉูู ุงุทูุงุนุงุช
- **ฺฉุงุฑุจุฑ ฺฉุงูู:** ููู ุงุตู + ุฏุณุชุฑุณ ฺฉุงูู
- ฺฉุจูุฑุฏูุง ูุนููู ุฒุจุง ู ฺฉุงุฑุจุฑูพุณูุฏ
- ูพุงูโูุง ูุงุฑุณ ฺฉุงูู ุจุง ุงููุฌโูุง ููุงุณุจ
- ุฏฺฉููโูุง inline ุจุฑุง ูุฑุงุด ุงุทูุงุนุงุช

### ๐พ **ูุฏุฑุช ุฏุงุฏู**
- ุฐุฎุฑู ุฏุฑ ูุงู JSON (`smart_registration.json`)
- ูุฏุฑุช ุญุงูุช ฺฉุงุฑุจุฑ (`userStates`)
- ูพฺฏุฑ ูุฑุงุญู ุซุจุช ูุงู
- ูพุดุชุจุงู ุงุฒ ฺฉุงุฑฺฏุงูโูุง

## ๐ ูุญูู ุงุณุชูุงุฏู

### **ูุตุจ ู ุฑุงูโุงูุฏุงุฒ**
```javascript
const SmartRegistrationModule = require('./14reg');
const registrationModule = new SmartRegistrationModule();
```

### **ูุชุฏูุง ุงุตู**

#### 1. **ูพุฑุฏุงุฒุด ูพุงูโูุง**
```javascript
const result = await registrationModule.handleMessage(message);
```

#### 2. **ูพุฑุฏุงุฒุด callback ูุง**
```javascript
const result = await registrationModule.handleCallback(callback);
```

#### 3. **ุฏุณุชูุฑ /start**
```javascript
const result = await registrationModule.handleStartCommand(chatId, userId);
```

## ๐ฑ **ุฌุฑุงู ฺฉุงุฑุจุฑ ุจูุจูุฏ ุงูุชู**

### **ฺฉุงุฑุจุฑ ุฌุฏุฏ (ูุงุดูุงุณ)**
```
1. /start โ ุฎูุดุงูุฏฺฏู + ุฏฺฉูู ุซุจุช ูุงู
2. ฺฉูฺฉ "๐ ุซุจุช ูุงู" โ ุดุฑูุน ูุณุชูู ุซุจุช ูุงู
3. ูุฑูุฏ ูุงู โ ูุฑูุฏ ฺฉุฏ ูู โ ูุฑูุฏ ุชููู โ ุชุฃุฏ
```

### **ฺฉุงุฑุจุฑ ููุฌูุฏ ูุงูุต**
```
1. /start โ ููู ุงุตู + ุฏุฑุฎูุงุณุช ุชฺฉูู
2. ุฏฺฉูู "โ๏ธ ุชฺฉูู ุซุจุชโูุงู" โ ุชฺฉูู ุงุทูุงุนุงุช
```

### **ฺฉุงุฑุจุฑ ฺฉุงูู**
```
1. /start โ ููู ุงุตู + ุฎูุดุงูุฏฺฏู ุดุฎุตโุณุงุฒ ุดุฏู
2. "ูุนุฑู ูุฏุฑุณู" โ ุฎูุดุงูุฏฺฏู ุดุฎุตโุณุงุฒ ุดุฏู
3. "ูพูู ูุฑุขูโุขููุฒ" โ ุฏุณุชุฑุณ ฺฉุงูู
4. "ุงูุชุฎุงุจ ฺฉูุงุณ" โ ูุณุช ฺฉุงุฑฺฏุงูโูุง
```

## ๐ง **ูุชุฏูุง ููู**

### **ุจุฑุฑุณ ูุถุนุช ฺฉุงุฑุจุฑ**
```javascript
// ุจุฑุฑุณ ุซุจุช ูุงู
const isRegistered = registrationModule.isUserRegistered(userId);

// ุจุฑุฑุณ ฺฉุงูู ุจูุฏู
const isComplete = registrationModule.isRegistrationComplete(userId);

// ุฏุฑุงูุช ููุฏูุง ูุงูุต
const missingFields = registrationModule.getMissingFields(userId);
```

### **ุงุนุชุจุงุฑุณูุฌ**
```javascript
// ุงุนุชุจุงุฑุณูุฌ ฺฉุฏ ูู
const isValid = registrationModule.isValidNationalId(nationalId);

// ุจุฑุฑุณ ูุฏุฑ ุจูุฏู
const isAdmin = registrationModule.isUserAdmin(phone);
```

### **ูุฏุฑุช ฺฉุงุฑฺฏุงูโูุง**
```javascript
// ุงูุชุฎุงุจ ฺฉุงุฑฺฏุงู
await registrationModule.handleWorkshopSelection(chatId, userId, workshopName);

// ูพูู ูุฑุขูโุขููุฒ
await registrationModule.handleQuranStudentPanel(chatId, userId);
```

## ๐ **ุณุงุฎุชุงุฑ ูุงู ุฏุงุฏู**

### **smart_registration.json**
```json
{
  "userData": {
    "userId": {
      "full_name": "ูุงู ฺฉุงูู",
      "first_name": "ูุงู ฺฉูฺฺฉ",
      "national_id": "ฺฉุฏ ูู",
      "phone": "ุดูุงุฑู ุชููู",
      "user_type": "quran_student",
      "registration_date": "ุชุงุฑุฎ ุซุจุช ูุงู"
    }
  },
  "userStates": {
    "userId": {
      "step": "ูุฑุญูู ูุนู",
      "data": "ุฏุงุฏูโูุง ูููุช"
    }
  },
  "lastUpdated": "ุชุงุฑุฎ ุขุฎุฑู ุจุฑูุฒุฑุณุงู"
}
```

## ๐ฏ **ูุฑุงุญู ุซุจุช ูุงู**

### **ูุฑุญูู 1: ูุงู**
- ุฏุฑุงูุช ูุงู ฺฉุงูู
- ุงุณุชุฎุฑุงุฌ ูุงู ฺฉูฺฺฉ
- ุงุนุชุจุงุฑุณูุฌ ุญุฏุงูู 2 ฺฉุงุฑุงฺฉุชุฑ
- ุฏฺฉูู ูุฑุงุด ูุงู

### **ูุฑุญูู 2: ฺฉุฏ ูู**
- ุงุนุชุจุงุฑุณูุฌ 10 ุฑูู
- ุฏฺฉููโูุง ูุฑุงุด ูุงู ู ฺฉุฏ ูู
- ููุงุด ูพุดุฑูุช

### **ูุฑุญูู 3: ุชููู**
- ุฏฺฉูู ุงุฑุณุงู ุชูุงุณ
- ุงุนุชุจุงุฑุณูุฌ ุดูุงุฑู
- ุฏฺฉููโูุง ูุฑุงุด ุชูุงู ููุฏูุง

### **ูุฑุญูู 4: ุชุฃุฏ**
- ููุงุด ุฎูุงุตู ุงุทูุงุนุงุช
- ุฏฺฉูู ุชุฃุฏ ููุง
- ุชุดุฎุต ุฎูุฏฺฉุงุฑ ููุด (ูุฑุจ/ุฏุงูุดโุขููุฒ)

## ๐ **ูุฏุฑุช ุฎุทุง ู ุจุงุฒฺฏุดุช**

### **ุฏฺฉููโูุง ุจุงุฒฺฏุดุช**
- "ุจุฑฺฏุดุช ุจู ูุจู" - ุจุงุฒฺฏุดุช ุจู ูุฑุญูู ูุจู
- "๐ ุจุฑฺฏุดุช ุจู ููู" - ุจุงุฒฺฏุดุช ุจู ููู ุงุตู
- "ุฎุฑูุฌ" - ุฎุฑูุฌ ุงุฒ ุฑุจุงุช

### **ูุฑุงุด ุงุทูุงุนุงุช**
- ุฏฺฉููโูุง inline ุจุฑุง ูุฑุงุด
- ุจุงุฒฺฏุดุช ุจู ูุฑุญูู ูุฑุจูุทู
- ุญูุธ ุฏุงุฏูโูุง ูุจู

## ๐ **ูฺฺฏโูุง ูพุดุฑูุชู**

### **ูุฏุฑุช ููุดโูุง**
- ุชุดุฎุต ุฎูุฏฺฉุงุฑ ูุฑุจ
- ุฏุณุชุฑุณโูุง ูุชูุงูุช
- ูพุงูโูุง ุดุฎุตโุณุงุฒ ุดุฏู

### **ุณุณุชู ฺฉุงุฑฺฏุงูโูุง**
- ูุณุช ฺฉุงุฑฺฏุงูโูุง ููุฌูุฏ
- ุงุทูุงุนุงุช ฺฉุงูู ูุฑ ฺฉุงุฑฺฏุงู
- ููฺฉ ูุณุชูู ู ุชูุงุณ

### **ุซุจุช ูุงู ูุงู ุขูุฏู**
- ุซุจุช ูุงู ูุณุชูู
- ุจุฑุฑุณ ูุถุนุช ููุฌูุฏ
- ูุฏุฑุช ฺฉุงุฑุจุฑุงู ูุงูุต

## ๐งช **ุชุณุช ู ุฏุจุงฺฏ**

### **ูุงู ุชุณุช**
```bash
node test_14reg.js
```

### **ูุงฺฏโูุง ููู**
```javascript
// ูุงฺฏโูุง ูุฑุงุญู ุซุจุช ูุงู
console.log(`๐ [14REG] User ${userId} moved from ${step} step`);

// ูุงฺฏโูุง ุฎุทุง
console.error(`โ [14REG] Error in ${method} for user ${userId}:`, error);

// ูุงฺฏโูุง ููููุช
console.log(`โ [14REG] ${action} completed successfully for user ${userId}`);
```

### **ููุงุท ุจุฑุฑุณ**
- ูุถุนุช `userStates`
- ูุญุชูุง `userData`
- ุงุนุชุจุงุฑุณูุฌ ูุฑูุฏโูุง
- ุฐุฎุฑู ู ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู

## ๐ **ุงููุช ู ุงุนุชุจุงุฑุณูุฌ**

### **ุงุนุชุจุงุฑุณูุฌ ูุฑูุฏ**
- ูุงู: ุญุฏุงูู 2 ฺฉุงุฑุงฺฉุชุฑ
- ฺฉุฏ ูู: ุฏููุงู 10 ุฑูู
- ุชููู: ูุฑูุช ุงุณุชุงูุฏุงุฑุฏ

### **ูุฏุฑุช ุฎุทุง**
- try-catch ุฏุฑ ุชูุงู ูุชุฏูุง
- ุจุฑุฑุณ ูุฌูุฏ ุฏุงุฏู
- ูพุงูโูุง ุฎุทุง ููุงุณุจ

## ๐ **ุจูููโุณุงุฒ**

### **ูุฏุฑุช ุญุงูุธู**
- ูพุงฺฉ ฺฉุฑุฏู `userStates` ูพุณ ุงุฒ ุชฺฉูู
- ุฐุฎุฑู ุฎูุฏฺฉุงุฑ ุฏุงุฏูโูุง
- ูุฏุฑุช ูุงูโูุง JSON

### **ุนููฺฉุฑุฏ**
- ุจุฑุฑุณ ุณุฑุน ูุถุนุช ฺฉุงุฑุจุฑ
- ูพุฑุฏุงุฒุด ุบุฑููุฒูุงู
- ูุฏุฑุช callback ูุง

## ๐ **ุฑุงูููุง ุนุจโุงุจ**

### **ูุดฺฉูุงุช ุฑุงุฌ**

#### 1. **ฺฉุงุฑุจุฑ ุฏุฑ ูุฑุญูู ฺฏุฑ ฺฉุฑุฏู**
```javascript
// ุจุฑุฑุณ ูุถุนุช
console.log(registrationModule.userStates[userId]);

// ูพุงฺฉ ฺฉุฑุฏู ูุถุนุช
delete registrationModule.userStates[userId];
```

#### 2. **ุฏุงุฏู ุฐุฎุฑู ููโุดูุฏ**
```javascript
// ุจุฑุฑุณ ูุงู
console.log(registrationModule.dataFile);

// ุฐุฎุฑู ุฏุณุช
registrationModule.saveData();
```

#### 3. **callback ฺฉุงุฑ ููโฺฉูุฏ**
```javascript
// ุจุฑุฑุณ ุฏุงุฏู callback
console.log(callback.data);

// ุจุฑุฑุณ ูุชุฏ handleCallback
console.log(registrationModule.handleCallback);
```

### **ูฺฉุงุช ููู**
- ููุดู ุงุฒ `await` ุงุณุชูุงุฏู ฺฉูุฏ
- ุจุฑุฑุณ ูุฌูุฏ `userId` ุฏุฑ `userData`
- ูุฏุฑุช ุฎุทุง ุฏุฑ ุชูุงู ูุชุฏูุง
- ูุงฺฏ ฺฉุฑุฏู ูุฑุงุญู ููู

## ๐ **ููููู ฺฉุฏ ฺฉุงูู**

```javascript
const SmartRegistrationModule = require('./14reg');

class BotHandler {
    constructor() {
        this.registrationModule = new SmartRegistrationModule();
    }

    async handleMessage(message) {
        try {
            const result = await this.registrationModule.handleMessage(message);
            if (result) {
                console.log('โ ูพุงู ุจุง ููููุช ูพุฑุฏุงุฒุด ุดุฏ');
            }
        } catch (error) {
            console.error('โ ุฎุทุง ุฏุฑ ูพุฑุฏุงุฒุด ูพุงู:', error);
        }
    }

    async handleCallback(callback) {
        try {
            const result = await this.registrationModule.handleCallback(callback);
            if (result) {
                console.log('โ Callback ุจุง ููููุช ูพุฑุฏุงุฒุด ุดุฏ');
            }
        } catch (error) {
            console.error('โ ุฎุทุง ุฏุฑ ูพุฑุฏุงุฒุด callback:', error);
        }
    }
}
```

## ๐ฏ **ูุฑุงุญู ุจุนุฏ**

### **ูฺฺฏโูุง ูพุดููุงุฏ**
- ุณุณุชู ูพุฑุฏุงุฎุช ุขููุงู
- ูุฏุฑุช ฺฉูุงุณโูุง
- ฺฏุฒุงุฑุดโฺฏุฑ ูพุดุฑูุชู
- API ุจุฑุง ูุจโุณุงุช

### **ุจูููโุณุงุฒ**
- ฺฉุด ฺฉุฑุฏู ุฏุงุฏูโูุง
- ูุฏุฑุช ููุฒูุงู
- ุงููุช ุจุดุชุฑ
- ุชุณุชโูุง ุฎูุฏฺฉุงุฑ

## ๐ **ุชุบุฑุงุช ูุณุจุช ุจู ูุณุฎู ูุจู**

### **ุจูุจูุฏูุง ุงุตู**
1. **ุฌุฑุงู ฺฉุงุฑุจุฑ ุจูุชุฑ:** ฺฉุงุฑุจุฑุงู ูุงุดูุงุณ ูุณุชููุงู ุฏฺฉูู ุซุจุช ูุงู ูโุจููุฏ
2. **ูพุงูโูุง ุดุฎุตโุณุงุฒ ุดุฏู:** ุจุฑ ุงุณุงุณ ูุถุนุช ฺฉุงุฑุจุฑ
3. **ูุฏุฑุช ุจูุชุฑ ุฎุทุง:** try-catch ุฏุฑ ุชูุงู ูุชุฏูุง
4. **ูุงฺฏโูุง ุจูุชุฑ:** ุจุง ูพุดููุฏ `[14REG]`
5. **ุณุงุฎุชุงุฑ ฺฉุฏ ุจูุจูุฏ ุงูุชู:** ูุชุฏูุง ูุฌุฒุง ู ูุงุจู ูฺฏูุฏุงุฑ

### **ูฺฺฏโูุง ุฌุฏุฏ**
- ุชุดุฎุต ุฎูุฏฺฉุงุฑ ููุด ฺฉุงุฑุจุฑ (ูุฑุจ/ุฏุงูุดโุขููุฒ)
- ุณุณุชู ฺฉุงุฑฺฏุงูโูุง
- ุซุจุช ูุงู ูุงู ุขูุฏู
- ูพูู ูุฑุขูโุขููุฒ

---

**๐ ูุงฺูู 14reg.js ุขูุงุฏู ุงุณุชูุงุฏู ุงุณุช!**

ุจุฑุง ุณูุงูุงุช ู ูุดฺฉูุงุช:
1. ุจุฑุฑุณ ูุงฺฏโูุง ุณุณุชู
2. ุชุณุช ูุฑุงุญู ุซุจุช ูุงู
3. ุจุฑุฑุณ ูุงูโูุง ุฏุงุฏู
4. ุชูุงุณ ุจุง ุชู ุชูุณุนู

