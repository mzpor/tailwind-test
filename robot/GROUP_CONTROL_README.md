# 🚪 راهنمای سیستم کنترل گروه‌ها

## نمای کلی سیستم

سیستم کنترل گروه‌ها امکان مدیریت هوشمندانه گروه‌های تلگرام را با قابلیت‌های زیر فراهم می‌کند:

### ✨ قابلیت‌ها

1. **زمان‌بندی خودکار** - باز و بسته کردن گروه‌ها در زمان‌های مشخص
2. **کنترل دستی** - مدیریت گروه‌ها از طریق پنل ادمین
3. **بلاک کردن پیام‌ها** - جلوگیری از ارسال پیام توسط کاربران عادی در گروه‌های بسته
4. **پیام‌های هوشمند** - ارسال پیام‌های مناسب هنگام تغییر وضعیت گروه

## 📋 نحوه استفاده

### 1. دسترسی به پنل کنترل گروه‌ها

- وارد پنل مدیر شوید (`/start`)
- روی دکمه **🚪 کنترل گروه‌ها** کلیک کنید

### 2. مشاهده وضعیت گروه‌ها

در پنل کنترل گروه‌ها می‌توانید:
- وضعیت فعلی هر گروه را مشاهده کنید
- زمان‌بندی‌های موجود را ببینید
- گروه‌های فعال/غیرفعال را شناسایی کنید

### 3. کنترل دستی گروه‌ها

برای هر گروه می‌توانید:
- **🔓 باز کردن گروه** - گروه را باز کنید
- **🔒 بستن گروه** - گروه را ببندید
- **⏰ افزودن زمان‌بندی** - زمان‌بندی جدید اضافه کنید
- **❌ حذف زمان‌بندی** - زمان‌بندی موجود را حذف کنید

### 4. تنظیم زمان‌بندی

#### ساختار زمان‌بندی:

```json
{
  "id": "schedule_example",
  "groupId": "GROUP_ID",
  "name": "نام زمان‌بندی",
  "enabled": true,
  "rules": [
    {
      "id": "rule_example",
      "name": "نام قانون",
      "enabled": true,
      "action": "open", // یا "close"
      "days": [0, 1, 2, 3, 4], // روزهای هفته (0=شنبه، 1=یکشنبه، ...)
      "startTime": "08:00", // ساعت شروع
      "endTime": "14:00", // ساعت پایان
      "message": "پیام دلخواه" // پیام هنگام تغییر وضعیت
    }
  ]
}
```

#### مثال‌های زمان‌بندی:

1. **گروه کلاس** - باز در ساعات کلاس:
```json
{
  "name": "ساعات کلاس",
  "action": "open",
  "days": [0, 1, 2, 3, 4], // شنبه تا چهارشنبه
  "startTime": "08:00",
  "endTime": "14:00",
  "message": "✅ گروه آماده برگزاری کلاس است."
}
```

2. **گروه پشتیبانی** - بسته در شب:
```json
{
  "name": "بستن شبانه",
  "action": "close",
  "days": [0, 1, 2, 3, 4, 5, 6], // همه روزها
  "startTime": "22:00",
  "endTime": "08:00",
  "message": "🚫 پشتیبانی تا صبح بسته است."
}
```

## ⚙️ تنظیمات پیشرفته

### فایل‌های کانفیگ:

1. **`data/groups_config.json`** - وضعیت پایه گروه‌ها
2. **`data/group_control_config.json`** - تنظیمات زمان‌بندی

### پیام‌های پیش‌فرض:

در فایل `group_control_config.json` می‌توانید پیام‌های پیش‌فرض را تغییر دهید:

```json
{
  "config": {
    "defaultCloseMessage": "🚫 گروه موقتاً بسته است.",
    "defaultOpenMessage": "✅ گروه باز است و آماده فعالیت!"
  }
}
```

## 🔒 امنیت و دسترسی

- فقط **مدیران** و **ادمین‌های گروه** می‌توانند گروه‌ها را کنترل کنند
- کاربران عادی نمی‌توانند در گروه‌های بسته پیام ارسال کنند
- تمام تغییرات در فایل‌های log ذخیره می‌شود

## 📊 گزارش‌گیری

سیستم به صورت خودکار گزارش تغییرات را در کنسول نمایش می‌دهد:

```
✅ [GROUP_CONTROL] Group 123456789 opened with message
⏰ [GROUP_CONTROL] Schedule timer started for group 123456789
🔄 [GROUP_CONTROL] Group 123456789 status set to: disabled by admin
```

## 🚀 راه‌اندازی سریع

1. فایل `group_control_config.json` را ویرایش کنید
2. زمان‌بندی‌های مورد نظر را اضافه کنید
3. ربات را راه‌اندازی کنید
4. از پنل کنترل گروه‌ها استفاده کنید

## ❗ نکات مهم

- زمان‌ها به فرمت 24 ساعته هستند
- روزهای هفته از 0 (شنبه) تا 6 (جمعه) شماره‌گذاری می‌شوند
- سیستم هر دقیقه زمان‌بندی‌ها را چک می‌کند
- پیام‌های تغییر وضعیت به گروه ارسال می‌شود
- تغییرات وضعیت در فایل `groups_config.json` ذخیره می‌شود

---

**سازنده:** تیم توسعه ربات Bale
**نسخه:** 1.0.0
**تاریخ:** ۱۴۰۴/۱۰/۲۴

