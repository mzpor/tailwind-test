# ๐ ุฑุงูููุง ฺฉูพุงุฑฺูโุณุงุฒ SSE - ุฑุจุงุช ู ุณุงุช

## ๐ ุฎูุงุตู
ุงู ุณุณุชู ุงุฒ **Server-Sent Events (SSE)** ุจุฑุง ููุงููฺฏ ุฏุงุฏูโูุง ุจู ุฑุจุงุช ุชูฺฏุฑุงู ู ุณุงุช ุงุณุชูุงุฏู ูโฺฉูุฏ. **ุจุฏูู polling** ู ููุท ุจุง ุฏุฑุฎูุงุณุช ฺฉุงุฑุจุฑ.

## ๐ง ูุดฺฉูุงุช ุญู ุดุฏู

### 1. โ ูุดฺฉู ฺฉุงุฑุจุฑ ูุงุดูุงุณ
- **ูุจู:** ูุฑ ูพุงู ูุนููู ุงุฒ ฺฉุงุฑุจุฑ ูุงุดูุงุณ ุจุงุนุซ ุงุฑุณุงู ูุฌุฏุฏ ูพุงู ุฎูุดโุขูุฏฺฏู ูโุดุฏ
- **ุจุนุฏ:** ฺฉุงุฑุจุฑ ููุท ฺฉ ุจุงุฑ ูพุงู ุฎูุดโุขูุฏฺฏู ุฏุฑุงูุช ูโฺฉูุฏ
- **ุฑุงูโุญู:** ุงุณุชูุงุฏู ุงุฒ ููุฏ `welcomeSent` ุจุฑุง ุนูุงูุชโฺฏุฐุงุฑ

### 2. โ ููุงููฺฏ ุฏุงุฏูโูุง
- **ูุจู:** ุฏุงุฏูโูุง ุฑุจุงุช ู ุณุงุช ุฌุฏุง ุจูุฏูุฏ
- **ุจุนุฏ:** ููุงููฺฏโุณุงุฒ ุฎูุฏฺฉุงุฑ ุจู `registrations.json` ู `registration_data.json`
- **ุฑุงูโุญู:** ุณุฑูุฑ SSE ุจุง API ูุง ฺฉูพุงุฑฺู

## ๐๏ธ ูุนูุงุฑ ุณุณุชู

```
โโโโโโโโโโโโโโโโโโโ    SSE    โโโโโโโโโโโโโโโโโโโ
โ   ุฑุจุงุช ุชูฺฏุฑุงู   โ โโโโโโโโโโบ โ   ุณุฑูุฑ SSE      โ
โ                 โ            โ                 โ
โ registrations   โ            โ API + Events    โ
โ .json          โ            โ                 โ
โโโโโโโโโโโโโโโโโโโ            โโโโโโโโโโโโโโโโโโโ
                                        โ
                                        โ HTTP API
                                        โผ
                               โโโโโโโโโโโโโโโโโโโ
                               โ   ุณุงุช React    โ
                               โ                 โ
                               โ SSE Client      โ
                               โ                 โ
                               โโโโโโโโโโโโโโโโโโโ
```

## ๐ ุฑุงูโุงูุฏุงุฒ

### ูุฑุญูู 1: ูุตุจ dependencies ุณุฑูุฑ SSE
```bash
cd robot
npm install --package-lock-only
npm install express cors
```

### ูุฑุญูู 2: ุงุฌุฑุง ุณุฑูุฑ SSE
```bash
cd robot
node sse_server.js
```

**ุฎุฑูุฌ ููุฑุฏ ุงูุชุธุงุฑ:**
```
๐ [SSE] Server running on port 3001
๐ [SSE] SSE endpoint: http://localhost:3001/api/sse
๐ [SSE] Stats endpoint: http://localhost:3001/api/stats
```

### ูุฑุญูู 3: ุงุฌุฑุง ุณุงุช
```bash
cd src
npm run dev
```

### ูุฑุญูู 4: ุชุณุช ุงุชุตุงู
1. ุจู ุณุงุช ุจุฑูุฏ
2. ุฑู ุฏฺฉูู **"ุงุชุตุงู SSE ๐"** ฺฉูฺฉ ฺฉูุฏ
3. ูุถุนุช ุงุชุตุงู ุฑุง ูุดุงูุฏู ฺฉูุฏ

## ๐ก API ูุง ุณุฑูุฑ SSE

### ๐ SSE Endpoint
```
GET /api/sse
```
- **ุชูุถุญ:** ุงุชุตุงู SSE ุจุฑุง ุฏุฑุงูุช ุชุบุฑุงุช real-time
- **ุงุณุชูุงุฏู:** ฺฉูุงูุชโูุง ุจุฑุง ุฏุฑุงูุช ุงุนูุงูโูุง

### ๐ ุขูุงุฑ ฺฉู
```
GET /api/stats
```
- **ุชูุถุญ:** ุฏุฑุงูุช ุขูุงุฑ ฺฉู ฺฉุงุฑุจุฑุงู
- **ูพุงุณุฎ:**
```json
{
  "total": 150,
  "incomplete": 45,
  "completed": 105,
  "botUsers": 80,
  "websiteUsers": 70,
  "lastUpdated": 1703123456789
}
```

### ๐ ุฌุณุชุฌู ฺฉุงุฑุจุฑุงู
```
GET /api/search?query=ุนู
```
- **ุชูุถุญ:** ุฌุณุชุฌู ุจุฑ ุงุณุงุณ ูุงูุ ฺฉุฏ ูู ุง ุชููู
- **ูพุงุณุฎ:** ุขุฑุงูโุง ุงุฒ ฺฉุงุฑุจุฑุงู ูุทุงุจู

### ๐ ูุณุช ฺฉุงุฑุจุฑุงู
```
GET /api/users?status=completed&source=bot
```
- **ุชูุถุญ:** ุฏุฑุงูุช ูุณุช ฺฉุงุฑุจุฑุงู ุจุง ููุชุฑ
- **ูพุงุฑุงูุชุฑูุง:**
  - `status`: ูุถุนุช ุซุจุชโูุงู
  - `source`: ููุจุน (bot/website)

### ๐ ุจูโุฑูุฒุฑุณุงู ฺฉุงุฑุจุฑ
```
POST /api/users/:userId
Content-Type: application/json

{
  "fullName": "ุนู ุงุญูุฏ",
  "phone": "09123456789"
}
```

### ๐ ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ
```
POST /api/users
Content-Type: application/json

{
  "fullName": "ุณุงุฑุง ูุญูุฏ",
  "nationalId": "1234567890",
  "phone": "09123456789"
}
```

## ๐ ฺฉูุงูุช SSE ุฏุฑ ุณุงุช

### ุงุณุชูุงุฏู ุฏุฑ ฺฉุงููพูููุช React
```jsx
import SSEClient from '../lib/sse-client';

const sseClient = new SSEClient('http://localhost:3001');

// ุงุชุตุงู ุจู ุณุฑูุฑ
sseClient.connect();

// ุซุจุช event handlers
sseClient.on('user_updated', (data) => {
  console.log('ฺฉุงุฑุจุฑ ุจูโุฑูุฒุฑุณุงู ุดุฏ:', data);
});

sseClient.on('user_created', (data) => {
  console.log('ฺฉุงุฑุจุฑ ุฌุฏุฏ ุงุฌุงุฏ ุดุฏ:', data);
});

// ุฏุฑุงูุช ุขูุงุฑ
const stats = await sseClient.getStats();
```

## ๐ ุฑูุฏุงุฏูุง SSE

### 1. `user_updated`
- **ุฒูุงู:** ููฺฏุงู ุจูโุฑูุฒุฑุณุงู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
- **ุฏุงุฏู:** `{ userId, updates }`

### 2. `user_created`
- **ุฒูุงู:** ููฺฏุงู ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ
- **ุฏุงุฏู:** `{ userId, userData }`

### 3. `connected`
- **ุฒูุงู:** ููฺฏุงู ุจุฑูุฑุงุฑ ุงุชุตุงู
- **ุฏุงุฏู:** `{ message: "ุงุชุตุงู SSE ุจุฑูุฑุงุฑ ุดุฏ" }`

## ๐๏ธ ุนุจโุงุจ

### ูุดฺฉู: ุณุฑูุฑ SSE ุงุฌุฑุง ููโุดูุฏ
```bash
# ุจุฑุฑุณ ูพูุฑุช
netstat -an | grep 3001

# ุจุฑุฑุณ dependencies
npm list express cors
```

### ูุดฺฉู: ุงุชุตุงู SSE ุจุฑูุฑุงุฑ ููโุดูุฏ
1. **ุจุฑุฑุณ CORS:** ุณุฑูุฑ SSE ุจุงุฏ CORS ุฑุง ูพุดุชุจุงู ฺฉูุฏ
2. **ุจุฑุฑุณ ูพูุฑุช:** ูพูุฑุช 3001 ุจุงุฏ ุขุฒุงุฏ ุจุงุดุฏ
3. **ุจุฑุฑุณ firewall:** firewall ุณุณุชู ุฑุง ุจุฑุฑุณ ฺฉูุฏ

### ูุดฺฉู: ุฏุงุฏูโูุง ููุงููฺฏ ููโุดููุฏ
1. **ุจุฑุฑุณ ูุงูโูุง:** `data/` directory ูุฌูุฏ ุฏุงุฑุฏุ
2. **ุจุฑุฑุณ permissions:** ูุงูโูุง ูุงุจู ุฎูุงูุฏู/ููุดุชู ูุณุชูุฏุ
3. **ุจุฑุฑุณ logs:** console ุณุฑูุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ

## ๐ ูุฒุงุง ุณุณุชู ุฌุฏุฏ

### โ ูุจู (ุณุณุชู ูุฏู)
- โ ฺฉุงุฑุจุฑ ูุงุดูุงุณ spam ูโฺฉุฑุฏ
- โ ุฏุงุฏูโูุง ุฑุจุงุช ู ุณุงุช ุฌุฏุง ุจูุฏูุฏ
- โ ูุงุฒ ุจู polling ูุฏุงูู
- โ ุนุฏู ููุงููฺฏ real-time

### โ ุจุนุฏ (ุณุณุชู ุฌุฏุฏ)
- โ ฺฉุงุฑุจุฑ ูุงุดูุงุณ ููุท ฺฉ ุจุงุฑ ูพุงู ุฏุฑุงูุช ูโฺฉูุฏ
- โ ููุงููฺฏ ุฎูุฏฺฉุงุฑ ุฏุงุฏูโูุง
- โ SSE ุจุฏูู polling
- โ ููุงููฺฏ real-time
- โ API ูุง ฺฉูพุงุฑฺู
- โ ูุฏุฑุช ุจูุชุฑ ุงุชุตุงู

## ๐ฎ ุชูุณุนูโูุง ุขูุฏู

### 1. ๐ ุงุญุฑุงุฒ ููุช
- JWT tokens ุจุฑุง API
- Rate limiting
- IP whitelist

### 2. ๐ ูุงูุชูุฑูฺฏ
- Logging ูพุดุฑูุชู
- Metrics collection
- Health checks

### 3. ๐ Sync ูพุดุฑูุชู
- Conflict resolution
- Data validation
- Backup & restore

### 4. ๐ WebSocket
- ุฌุงฺฏุฒู SSE ุจุง WebSocket
- Bi-directional communication
- Real-time chat

## ๐ ูพุดุชุจุงู

ุจุฑุง ุณูุงูุงุช ู ูุดฺฉูุงุช:
1. **Logs:** console ุณุฑูุฑ ู ูุฑูุฑฺฏุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. **Network:** Network tab ูุฑูุฑฺฏุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
3. **API:** endpoint ูุง ุฑุง ุจุง Postman ุชุณุช ฺฉูุฏ

---

**๐ฏ ูุฏู:** ุงุฌุงุฏ ุณุณุชู ฺฉูพุงุฑฺู ู ฺฉุงุฑุขูุฏ ุจุฑุง ูุฏุฑุช ุซุจุชโูุงู ุจู ุฑุจุงุช ู ุณุงุช
